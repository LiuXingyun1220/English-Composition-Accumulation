## 1. 实对称矩阵相似的充要条件

> [!abstract] 定理
> 实对称矩阵 $A$ 与 $B$ 相似的充分必要条件是：$A$ 与 $B$ 有相同的特征值（即特征多项式相同）。

### 证明

**1. 必要性 ($\Rightarrow$)：**
若 $A \sim B$，根据相似矩阵的性质，它们的特征多项式相同，因此必有相同的特征值。
*(注：这对于任意矩阵都成立，不仅限于实对称矩阵)*。

**2. 充分性 ($\Leftarrow$)：**
这是实对称矩阵的**特殊性质**。
* 根据**实对称矩阵必可正交对角化**的性质：
    * 对于 $A$，存在正交阵 $P_1$ 使得 $P_1^{-1}AP_1 = \Lambda_A$。
    * 对于 $B$，存在正交阵 $P_2$ 使得 $P_2^{-1}BP_2 = \Lambda_B$。
* 若 $A, B$ 有相同的特征值，则调整对角元顺序后，必有 $\Lambda_A = \Lambda_B = \Lambda$。
* 由传递性：$A \sim \Lambda$ 且 $B \sim \Lambda \implies A \sim B$。

> [!important] 核心逻辑
> 普通矩阵特征值相同不一定相似，但**实对称矩阵一定能对角化**，特征值相同即相似。

---

## 2. 特征值与惯性指数的关系

> [!question] 为什么 $A$ 的正特征值个数 = 正惯性指数 $p$？

### 解释与证明

**1. 二次型的矩阵表示**
设二次型 $f(x) = x^T A x$，其中 $A$ 为实对称矩阵。

**2. 正交变换法（变为标准形）**
因为 $A$ 是实对称矩阵，必存在正交变换 $x = Qy$（$Q$ 为正交矩阵，即 $Q^{-1}=Q^T$），使得 $Q^T A Q = \Lambda = \text{diag}(\lambda_1, \dots, \lambda_n)$。
代入二次型：
$$
f(x) = (Qy)^T A (Qy) = y^T (Q^T A Q) y = y^T \Lambda y = \sum_{i=1}^n \lambda_i y_i^2
$$
此时，二次型变为**标准形**：
$$
f = \lambda_1 y_1^2 + \lambda_2 y_2^2 + \dots + \lambda_n y_n^2
$$

**3. 结论**
在上述标准形中，系数正是特征值 $\lambda_i$。
* **正项个数** = $\lambda_i > 0$ 的个数 $\implies p =$ 正特征值个数。
* **负项个数** = $\lambda_i < 0$ 的个数 $\implies q =$ 负特征值个数。

### 规范形系数
通过进一步的坐标变换 $z_i = \sqrt{|\lambda_i|} y_i$，可以将系数变为 $1$ 或 $-1$。
* **规范形**：$z_1^2 + \dots + z_p^2 - z_{p+1}^2 - \dots - z_{p+q}^2$。
* 显然，系数为 $1$ 的项数依然对应正特征值的数量。

---

## 3. 相似必合同，反之未必

> [!example] 结论
> 实对称矩阵 $A$ 与实对称矩阵 $B$ **相似 $\Rightarrow$ 合同**。
> 实对称矩阵 $A$ 与实对称矩阵 $B$ **合同 $\nRightarrow$ 相似**。
### 合同的定义
两个实对称矩阵 $A$ 和 $B$ 是合同的，如果存在一个可逆矩阵 $C$，使得：

$$C^T A C = B$$

这里的矩阵 $C$ 通常对应于二次型变换中的过渡矩阵。
### 证明：相似 $\implies$ 合同

1.  若 $A \sim B$（相似），则它们有相同的特征值。
2.  由上述“特征值与惯性指数”的关系可知，它们具有相同的正特征值个数 $p$ 和负特征值个数 $q$。
3.  即 $A$ 和 $B$ 的正惯性指数和负惯性指数分别相等。
4.  根据**西尔维斯特惯性定理 (Sylvester's Law of Inertia)**：两个实对称矩阵合同的充要条件是它们有相同的正负惯性指数。
5.  $\therefore A \simeq B$（合同）。

### 反例：合同 $\nRightarrow$ 相似

合同只要求符号（正负号个数）相同，不要求数值相等；而相似要求数值（特征值）完全相等。

**构造反例：**
令 $A = E = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}$， $B = 2E = \begin{pmatrix} 2 & 0 \\ 0 & 2 \end{pmatrix}$。

1.  **看惯性指数（合同性）：**
    * $A$ 的特征值为 $1, 1$ ($p=2, q=0$)。
    * $B$ 的特征值为 $2, 2$ ($p=2, q=0$)。
    * $p, q$ 相同 $\implies A \simeq B$（合同）。
2.  **看特征值（相似性）：**
    * $\lambda_A = \{1, 1\}$，$\lambda_B = \{2, 2\}$。
    * 特征值不同 $\implies A \nsim B$（不相似）。

> [!summary] 总结
> * **相似**：要求高，仿佛“全等三角形”，形状大小都要一样（特征值值相同）。
> * **合同**：要求低，仿佛“相似三角形”，只要正负方向一致即可（惯性指数相同）。

---

## 4. 谱分解定理 (Spectral Decomposition Theorem)

这是实对称矩阵对角化的一种“积木式”表达，非常利于理解矩阵的几何作用。

> [!theorem] 谱分解定理
> 设 $A$ 是 $n$ 阶实对称矩阵，其特征值为 $\lambda_1, \dots, \lambda_n$，对应的单位正交特征向量为 $u_1, \dots, u_n$。
> 则 $A$ 可以分解为：
> $$A = \lambda_1 u_1 u_1^T + \lambda_2 u_2 u_2^T + \dots + \lambda_n u_n u_n^T$$

### 证明推导

1.  **正交对角化**：
    存在正交矩阵 $P = (u_1, u_2, \dots, u_n)$，使得 $A = P \Lambda P^T$。
2.  **矩阵分块乘法展开**：
    $$
    \begin{aligned}
    A &= \begin{pmatrix} u_1 & u_2 & \dots & u_n \end{pmatrix} 
       \begin{pmatrix} 
       \lambda_1 & & & \\
       & \lambda_2 & & \\
       & & \ddots & \\
       & & & \lambda_n
       \end{pmatrix}
       \begin{pmatrix} u_1^T \\ u_2^T \\ \vdots \\ u_n^T \end{pmatrix} \\
    &= \begin{pmatrix} \lambda_1 u_1 & \lambda_2 u_2 & \dots & \lambda_n u_n \end{pmatrix}
       \begin{pmatrix} u_1^T \\ u_2^T \\ \vdots \\ u_n^T \end{pmatrix} \\
    &= \lambda_1 u_1 u_1^T + \lambda_2 u_2 u_2^T + \dots + \lambda_n u_n u_n^T
    \end{aligned}
    $$

### 几何意义
* **$u_i u_i^T$ 是什么？**
    它是一个**投影矩阵**（Projection Matrix），表示向向量 $u_i$ 方向的投影算子。
    * 性质：$(u_i u_i^T)^2 = u_i (u_i^T u_i) u_i^T = u_i u_i^T$（幂等性）。
    * 性质：$tr(u_i u_i^T) = 1$（秩为1）。
* **物理图景**：
    矩阵 $A$ 的作用，相当于把向量分别投影到各个正交的特征方向 $u_i$ 上，然后在该方向上拉伸 $\lambda_i$ 倍，最后叠加起来。
